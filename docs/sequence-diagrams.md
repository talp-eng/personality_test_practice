# シーケンス図 - 性格診断アプリ

このドキュメントは、性格診断アプリの主な機能が、どのような順序で処理されるかを時系列で示した図（シーケンス図）をまとめたものです。

### シーケンス図とは？

登場人物（このアプリでは「ユーザー」「画面」「プログラム」）の間で、どのようなメッセージや指示が、どの順番で行われるかを示した図です。「誰が」「いつ」「何をするか」を分かりやすく表現します。

---

### 1. 診断を開始する

ユーザーがスタート画面で「診断開始」ボタンを押してから、最初の質問が表示されるまでの流れです。

```mermaid
sequenceDiagram
    participant User as ユーザー
    participant UI as ブラウザ/UI (画面)
    participant Logic as アプリのロジック (プログラム)

    User->>UI: 「診断開始」ボタンをクリック
    UI->>Logic: 診断開始の指示を出す
    Logic->>Logic: 最初の質問データを用意する
    Logic-->>UI: 最初の質問を表示するよう指示
    UI-->>User: 診断画面と最初の質問を表示する
```

**解説:**
ユーザーがボタンを押すと、画面はその操作をプログラムに伝えます。プログラムは表示すべき最初の質問を準備し、それを画面に渡して表示させます。

---

### 2. 質問に回答し、次の質問へ進む

ユーザーが一つの質問に答えてから、次の質問が表示されるまでの流れです。

```mermaid
sequenceDiagram
    participant User as ユーザー
    participant UI as ブラウザ/UI (画面)
    participant Logic as アプリのロジック (プログラム)

    User->>UI: 回答の選択肢をクリック
    UI->>Logic: 選ばれた回答を伝える
    Logic->>Logic: 回答を記録・集計する
    Logic->>Logic: 次の質問があるか確認する
    alt 次の質問がある場合
        Logic->>Logic: 次の質問データを用意する
        Logic-->>UI: 次の質問を表示するよう指示
        UI-->>User: 次の質問を表示する
    else 次の質問がない場合
        note over Logic: (「3. 診断を完了し、結果を表示する」へ続く)
    end
```

**解説:**
ユーザーが回答を選ぶと、プログラムはその選択を記録します。そして、まだ答えていない質問があれば、次の質問を画面に表示します。この流れを最後の質問まで繰り返します。

---

### 3. 診断を完了し、結果を表示する

最後の質問に答えてから、診断結果が表示されるまでの流れです。

```mermaid
sequenceDiagram
    participant User as ユーザー
    participant UI as ブラウザ/UI (画面)
    participant Logic as アプリのロジック (プログラム)

    User->>UI: 最後の質問の回答をクリック
    UI->>Logic: 選ばれた回答を伝える
    Logic->>Logic: 最後の回答を記録・集計する
    Logic->>Logic: これまでの回答から最も多かった性格タイプを計算する
    Logic->>Logic: 計算結果の性格タイプのデータ（名前や説明文）を用意する
    Logic-->>UI: 結果を表示するよう指示
    UI-->>User: 結果表示画面と診断結果を表示する
```

**解説:**
最後の質問に答えると、プログラムはこれまでの回答を集計し、どの性格タイプに最も当てはまるかを計算します。そして、その結果（性格タイプの名前や詳しい説明）を画面に表示します。

---

### 4. もう一度診断する

結果画面で「もう一度診断する」ボタンを押してから、スタート画面に戻るまでの流れです。

```mermaid
sequenceDiagram
    participant User as ユーザー
    participant UI as ブラウザ/UI (画面)
    participant Logic as アプリのロジック (プログラム)

    User->>UI: 「もう一度診断する」ボタンをクリック
    UI->>Logic: 最初からやり直す指示を出す
    Logic->>Logic: これまでの回答記録をすべてリセットする
    Logic-->>UI: スタート画面を表示するよう指示
    UI-->>User: スタート画面を表示する
```

**解説:**
ユーザーが「もう一度」ボタンを押すと、プログラムは今までの回答データをすべて消去して、アプリを一番最初の状態に戻します。これにより、まっさらな状態から再び診断を始めることができます。